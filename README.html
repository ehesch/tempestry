<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.335">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="dcterms.date" content="2023-04-25">

<title>Tempestry aRt</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="README_files/libs/clipboard/clipboard.min.js"></script>
<script src="README_files/libs/quarto-html/quarto.js"></script>
<script src="README_files/libs/quarto-html/popper.min.js"></script>
<script src="README_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="README_files/libs/quarto-html/anchor.min.js"></script>
<link href="README_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="README_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="README_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="README_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="README_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="README_files/libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="README_files/libs/jquery-1.12.4/jquery.min.js"></script>
<link href="README_files/libs/leaflet-1.3.1/leaflet.css" rel="stylesheet">
<script src="README_files/libs/leaflet-1.3.1/leaflet.js"></script>
<link href="README_files/libs/leafletfix-1.0.0/leafletfix.css" rel="stylesheet">
<script src="README_files/libs/proj4-2.6.2/proj4.min.js"></script>
<script src="README_files/libs/Proj4Leaflet-1.0.1/proj4leaflet.js"></script>
<link href="README_files/libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css" rel="stylesheet">
<script src="README_files/libs/leaflet-binding-2.1.1/leaflet.js"></script>
<script src="README_files/libs/leaflet-providers-1.9.0/leaflet-providers_1.9.0.js"></script>
<script src="README_files/libs/leaflet-providers-plugin-2.1.1/leaflet-providers-plugin.js"></script>
<link href="README_files/libs/HomeButton-0.0.1/home-button.css" rel="stylesheet">
<script src="README_files/libs/HomeButton-0.0.1/home-button.js"></script>
<script src="README_files/libs/HomeButton-0.0.1/easy-button-src.min.js"></script>
<script src="README_files/libs/clipboard-0.0.1/setClipboardText.js"></script>
<link href="README_files/libs/mapviewCSS-0.0.1/mapview-popup.css" rel="stylesheet">
<link href="README_files/libs/mapviewCSS-0.0.1/mapview.css" rel="stylesheet">


</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Tempestry aRt</h1>
</div>



<div class="quarto-title-meta">

    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">April 25, 2023</p>
    </div>
  </div>
  
    
  </div>
  

</header>

<div class="cell">

</div>
<p>This script produces a climate art! It is inspired by the <a href="https://www.tempestryproject.com/">Tempestry Project</a> and <a href="https://en.wikipedia.org/wiki/Warming_stripes">warming stripes</a>.</p>
<p>It will help you make a poster showing about 100 years of temperature data for various places. You’ll get the <strong>annual trend</strong> along with 365 days of <strong>daily temperature</strong> for each year! For some places, you can also add other weather data (e.g.&nbsp;over a century of data on when Lake Superior’s ice road to Madeline Island is open)!</p>
<p>Since this is art, there are some small creative liberties taken (i.e., filling in of missing data, usage of different color breaks based on what looks good, using multiple NOAA weather stations which aren’t aligned with their dates of records, etc.). Also, since this is art, many details and data best practices are intentionally left out (i.e., you won’t find a figure legend here!). The data is roughly at the county level, but modifications to different geographies should be possible!</p>
<p>Once you make your poster art, I have had good luck <a href="https://www.office.fedex.com/default/posters.html">printing at FedEx</a>. Cost of $17.25 for a poster print (matte paper, vertical orientation, size 16x20). But feel free to figure out what works for you (more convenient location/store, maybe you have a bigger or smaller picture frame already on hand that you’d like to use, maybe you want a fancier option like a foam board backing, etc.).</p>
<section id="creating-your-poster" class="level1">
<h1>Creating your poster</h1>
<section id="set-up" class="level2">
<h2 class="anchored" data-anchor-id="set-up">Set-up</h2>
<p>You will need to use an API key to connect to the NOAA database. <a href="https://www.ncdc.noaa.gov/cdo-web/token">Request an API key here</a>, then add the key to your <code>.Renviron</code> file. Enter in the console <code>usethis::edit_r_environ()</code> and type <code>NOAA_KEY="KEY GOES HERE, INSIDE QUOTES"</code>. Save and close the <code>.Renviron</code> file, and restart R.</p>
</section>
<section id="daily-temperatures" class="level2">
<h2 class="anchored" data-anchor-id="daily-temperatures">Daily temperatures</h2>
<section id="fetch-station-data" class="level3">
<h3 class="anchored" data-anchor-id="fetch-station-data">Fetch station data</h3>
<p>The daily temperatures are fetched from stations within a certain distance from a given latitude and longitude (i.e., your home or another sentimental place). Sometimes the distance radius needs to be increased if stations are sparse, and other times the specific latitude and longitude might need to be adjusted to get what you want. Basically, this is part of the art - figure out what looks good.</p>
<p>As an FYI, fetching station data does take a while. The very first time this code is run, you’ll get stations names for all NOAA stations in the US (that takes a while, but only needs to happen once). Whenever you change the location for which you’d like to get data, it’ll also take a while to run.</p>
<p>Sometimes the closest stations to the site need to be adjusted. A couple tips: 1) The maximum number of stations to fetch data from is capped at 15. You may want to increase or decrease this number (edit the <code>limit</code> call). 2) The stations can have different data availability, but generally it seems like longer-term stations are more ideal for the art. Still, you might need to adjust (edit the <code>year_min</code> and <code>year_max</code> calls).<br>
3) The code will attempt to fetch data through the most recently completed year, but you may need to write over your data cache to start displaying the most up-to-date data.</p>
<div class="cell">
<div class="cell-output-display">

<div id="htmlwidget-3a647fc241fd908b8116" style="width:100%;height:464px;" class="leaflet html-widget"></div>
<script type="application/json" data-for="htmlwidget-3a647fc241fd908b8116">{"x":{"options":{"minZoom":1,"maxZoom":52,"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"preferCanvas":false,"bounceAtZoomLimits":false,"maxBounds":[[[-90,-370]],[[90,370]]]},"calls":[{"method":"addProviderTiles","args":["CartoDB.Positron","CartoDB.Positron","CartoDB.Positron",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["CartoDB.DarkMatter","CartoDB.DarkMatter","CartoDB.DarkMatter",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenStreetMap","OpenStreetMap","OpenStreetMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["Esri.WorldImagery","Esri.WorldImagery","Esri.WorldImagery",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"addProviderTiles","args":["OpenTopoMap","OpenTopoMap","OpenTopoMap",{"errorTileUrl":"","noWrap":false,"detectRetina":false,"pane":"tilePane"}]},{"method":"createMapPane","args":["point",440]},{"method":"addCircleMarkers","args":[[44.7597,44.8544,44.8853,44.9311,44.9322,44.9461,44.9783,44.9903,45.0417,45.0456,45.0483],[-92.8689,-92.6122,-93.2314,-93.1539,-93.0558,-93.03,-93.2469,-93.18,-92.7975,-92.8522,-93.0958],6,null,".",{"crs":{"crsClass":"L.CRS.EPSG3857","code":null,"proj4def":null,"projectedBounds":null,"options":{}},"pane":"point","stroke":true,"color":"#333333","weight":1,"opacity":0.9,"fill":true,"fillColor":"#6666FF","fillOpacity":0.6},null,null,["<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>1&emsp;<\/td><\/tr><tr><td>1<\/td><th>name&emsp;<\/th><td>HASTINGS DAM 2&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>USC00213567&emsp;<\/td><\/tr><tr><td>3<\/td><th>mindate&emsp;<\/th><td>1893-08-01&emsp;<\/td><\/tr><tr><td>4<\/td><th>maxdate&emsp;<\/th><td>2022-12-31&emsp;<\/td><\/tr><tr><td>5<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>2&emsp;<\/td><\/tr><tr><td>1<\/td><th>name&emsp;<\/th><td>RIVER FALLS&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>USC00477226&emsp;<\/td><\/tr><tr><td>3<\/td><th>mindate&emsp;<\/th><td>1918-04-01&emsp;<\/td><\/tr><tr><td>4<\/td><th>maxdate&emsp;<\/th><td>2022-12-31&emsp;<\/td><\/tr><tr><td>5<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>3&emsp;<\/td><\/tr><tr><td>1<\/td><th>name&emsp;<\/th><td>MINNEAPOLIS-ST PAUL INTL AP&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>USW00014922&emsp;<\/td><\/tr><tr><td>3<\/td><th>mindate&emsp;<\/th><td>1938-04-01&emsp;<\/td><\/tr><tr><td>4<\/td><th>maxdate&emsp;<\/th><td>2022-12-31&emsp;<\/td><\/tr><tr><td>5<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>4&emsp;<\/td><\/tr><tr><td>1<\/td><th>name&emsp;<\/th><td>ST PAUL 3SW&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>USC00217379&emsp;<\/td><\/tr><tr><td>3<\/td><th>mindate&emsp;<\/th><td>2006-07-01&emsp;<\/td><\/tr><tr><td>4<\/td><th>maxdate&emsp;<\/th><td>2017-07-31&emsp;<\/td><\/tr><tr><td>5<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>5&emsp;<\/td><\/tr><tr><td>1<\/td><th>name&emsp;<\/th><td>ST PAUL DWTN AP&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>USW00014927&emsp;<\/td><\/tr><tr><td>3<\/td><th>mindate&emsp;<\/th><td>1937-01-01&emsp;<\/td><\/tr><tr><td>4<\/td><th>maxdate&emsp;<\/th><td>2022-12-31&emsp;<\/td><\/tr><tr><td>5<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>6&emsp;<\/td><\/tr><tr><td>1<\/td><th>name&emsp;<\/th><td>ST PAUL&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>USC00217377&emsp;<\/td><\/tr><tr><td>3<\/td><th>mindate&emsp;<\/th><td>1956-12-01&emsp;<\/td><\/tr><tr><td>4<\/td><th>maxdate&emsp;<\/th><td>2006-05-31&emsp;<\/td><\/tr><tr><td>5<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>7&emsp;<\/td><\/tr><tr><td>1<\/td><th>name&emsp;<\/th><td>LOWER ST ANTHONY FALLS&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>USC00214884&emsp;<\/td><\/tr><tr><td>3<\/td><th>mindate&emsp;<\/th><td>1992-06-01&emsp;<\/td><\/tr><tr><td>4<\/td><th>maxdate&emsp;<\/th><td>2022-12-31&emsp;<\/td><\/tr><tr><td>5<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>8&emsp;<\/td><\/tr><tr><td>1<\/td><th>name&emsp;<\/th><td>U OF MN ST PAUL&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>USC00218450&emsp;<\/td><\/tr><tr><td>3<\/td><th>mindate&emsp;<\/th><td>1963-01-01&emsp;<\/td><\/tr><tr><td>4<\/td><th>maxdate&emsp;<\/th><td>2022-12-31&emsp;<\/td><\/tr><tr><td>5<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>9&emsp;<\/td><\/tr><tr><td>1<\/td><th>name&emsp;<\/th><td>STILLWATER 1 SE&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>USC00218037&emsp;<\/td><\/tr><tr><td>3<\/td><th>mindate&emsp;<\/th><td>1958-11-01&emsp;<\/td><\/tr><tr><td>4<\/td><th>maxdate&emsp;<\/th><td>2006-01-31&emsp;<\/td><\/tr><tr><td>5<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>10&emsp;<\/td><\/tr><tr><td>1<\/td><th>name&emsp;<\/th><td>STILLWATER 2SW&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>USC00218039&emsp;<\/td><\/tr><tr><td>3<\/td><th>mindate&emsp;<\/th><td>2006-07-01&emsp;<\/td><\/tr><tr><td>4<\/td><th>maxdate&emsp;<\/th><td>2022-12-31&emsp;<\/td><\/tr><tr><td>5<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>","<div class='scrollableContainer'><table class=mapview-popup id='popup'><tr class='coord'><td><\/td><th><b>Feature ID&emsp;<\/b><\/th><td>11&emsp;<\/td><\/tr><tr><td>1<\/td><th>name&emsp;<\/th><td>VADNAIS LAKE&emsp;<\/td><\/tr><tr><td>2<\/td><th>id&emsp;<\/th><td>USC00218477&emsp;<\/td><\/tr><tr><td>3<\/td><th>mindate&emsp;<\/th><td>1981-10-01&emsp;<\/td><\/tr><tr><td>4<\/td><th>maxdate&emsp;<\/th><td>2022-12-31&emsp;<\/td><\/tr><tr><td>5<\/td><th>geometry&emsp;<\/th><td>sfc_POINT&emsp;<\/td><\/tr><\/table><\/div>"],{"maxWidth":800,"minWidth":50,"autoPan":true,"keepInView":false,"closeButton":true,"closeOnClick":true,"className":""},["1","2","3","4","5","6","7","8","9","10","11"],{"interactive":false,"permanent":false,"direction":"auto","opacity":1,"offset":[0,0],"textsize":"10px","textOnly":false,"className":"","sticky":true},null]},{"method":"addScaleBar","args":[{"maxWidth":100,"metric":true,"imperial":true,"updateWhenIdle":true,"position":"bottomleft"}]},{"method":"addHomeButton","args":[-93.2469,44.7597,-92.6122,45.0483,true,".","Zoom to .","<strong> . <\/strong>","bottomright"]},{"method":"addLayersControl","args":[["CartoDB.Positron","CartoDB.DarkMatter","OpenStreetMap","Esri.WorldImagery","OpenTopoMap"],".",{"collapsed":true,"autoZIndex":true,"position":"topleft"}]},{"method":"addLegend","args":[{"colors":["#6666FF"],"labels":["."],"na_color":null,"na_label":"NA","opacity":1,"position":"topright","type":"factor","title":"","extra":null,"layerId":null,"className":"info legend","group":"."}]}],"limits":{"lat":[44.7597,45.0483],"lng":[-93.2469,-92.6122]},"fitBounds":[44.7597,-93.2469,45.0483,-92.6122,[]]},"evals":[],"jsHooks":{"render":[{"code":"function(el, x, data) {\n  return (\n      function(el, x, data) {\n      // get the leaflet map\n      var map = this; //HTMLWidgets.find('#' + el.id);\n      // we need a new div element because we have to handle\n      // the mouseover output separately\n      // debugger;\n      function addElement () {\n      // generate new div Element\n      var newDiv = $(document.createElement('div'));\n      // append at end of leaflet htmlwidget container\n      $(el).append(newDiv);\n      //provide ID and style\n      newDiv.addClass('lnlt');\n      newDiv.css({\n      'position': 'relative',\n      'bottomleft':  '0px',\n      'background-color': 'rgba(255, 255, 255, 0.7)',\n      'box-shadow': '0 0 2px #bbb',\n      'background-clip': 'padding-box',\n      'margin': '0',\n      'padding-left': '5px',\n      'color': '#333',\n      'font': '9px/1.5 \"Helvetica Neue\", Arial, Helvetica, sans-serif',\n      'z-index': '700',\n      });\n      return newDiv;\n      }\n\n\n      // check for already existing lnlt class to not duplicate\n      var lnlt = $(el).find('.lnlt');\n\n      if(!lnlt.length) {\n      lnlt = addElement();\n\n      // grab the special div we generated in the beginning\n      // and put the mousmove output there\n\n      map.on('mousemove', function (e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                           ' lon: ' + (e.latlng.lng).toFixed(5) +\n                           ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                           ' | zoom: ' + map.getZoom() +\n                           ' | x: ' + L.CRS.EPSG3857.project(e.latlng).x.toFixed(0) +\n                           ' | y: ' + L.CRS.EPSG3857.project(e.latlng).y.toFixed(0) +\n                           ' | epsg: 3857 ' +\n                           ' | proj4: +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs ');\n      } else {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      }\n      });\n\n      // remove the lnlt div when mouse leaves map\n      map.on('mouseout', function (e) {\n      var strip = document.querySelector('.lnlt');\n      if( strip !==null) strip.remove();\n      });\n\n      };\n\n      //$(el).keypress(67, function(e) {\n      map.on('preclick', function(e) {\n      if (e.originalEvent.ctrlKey) {\n      if (document.querySelector('.lnlt') === null) lnlt = addElement();\n      lnlt.text(\n                      ' lon: ' + (e.latlng.lng).toFixed(5) +\n                      ' | lat: ' + (e.latlng.lat).toFixed(5) +\n                      ' | zoom: ' + map.getZoom() + ' ');\n      var txt = document.querySelector('.lnlt').textContent;\n      console.log(txt);\n      //txt.innerText.focus();\n      //txt.select();\n      setClipboardText('\"' + txt + '\"');\n      }\n      });\n\n      }\n      ).call(this.getMap(), el, x, data);\n}","data":null},{"code":"function(el, x, data) {\n  return (function(el,x,data){\n           var map = this;\n\n           map.on('keypress', function(e) {\n               console.log(e.originalEvent.code);\n               var key = e.originalEvent.code;\n               if (key === 'KeyE') {\n                   var bb = this.getBounds();\n                   var txt = JSON.stringify(bb);\n                   console.log(txt);\n\n                   setClipboardText('\\'' + txt + '\\'');\n               }\n           })\n        }).call(this.getMap(), el, x, data);\n}","data":null}]}}</script>
</div>
</div>
</section>
<section id="decide-what-years-to-use" class="level3">
<h3 class="anchored" data-anchor-id="decide-what-years-to-use">Decide what years to use</h3>
<p>This is a balance! You probably want as many years of data as possible, but some of the early records are spotty or missing. Some steps are designed to deal with small missing data records, but you still need to figure out a good starting year. The code below gets you to a good estimate of what year to start at, but you may need to revisit it once you see what the plots look like.</p>
<p>This <code>min_year</code> is a <em>global</em> parameter, which is passed to the processing and plotting for both the daily and annual temperatures. So if (when) this parameter is adjusted, all code chunks below this also should be re-run (and subsequently styled). You’ll know an adjustment to the <code>min_year</code> is needed if you see long “streaks” of the same daily temperatures.</p>
<div class="cell">

</div>
</section>
<section id="make-daily-plot" class="level3">
<h3 class="anchored" data-anchor-id="make-daily-plot">Make daily plot</h3>
<p>You will probably be reprocessing this piece several times to make it look nice. The daily average temperatures get mapped (#aesthetics), so just know that going into any manual adjustments you may be making.</p>
<p>Tips:</p>
<ul>
<li>Starting points for the temperature thresholds have been populated, but tweak as needed. Looking at the count of entries in each category can also be helpful (roughly even split between hot/cold, and even but less than !1000 in the extreme categories).</li>
<li>You’ll probably end up trimming the dates included (i.e., starting the plots at a later date than the earliest potential date), which will mess with the starting point color scheme.</li>
<li>Finally, you might have other aesthetic preferences! Establishing a consistent color scheme across multiple locations? Have a predefined parameter for extreme hot or cold temperatures?</li>
</ul>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  temp_category     n
  &lt;fct&gt;         &lt;int&gt;
1 extreme cold   1090
2 cold          17565
3 hot           18099
4 extreme hot     943</code></pre>
</div>
<div class="cell-output-display">
<p><img src="README_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="annual-average-temperatures" class="level2">
<h2 class="anchored" data-anchor-id="annual-average-temperatures">Annual average temperatures</h2>
<section id="fetch-annual-data" class="level3">
<h3 class="anchored" data-anchor-id="fetch-annual-data">Fetch annual data</h3>
<p><a href="https://www.ncei.noaa.gov/access/monitoring/climate-at-a-glance/county/time-series/MN-163/tavg/ann/2/1895-2023">Manually download county-level average temperatures</a> from NOAA. Annual averages are calculated using <a href="https://www.ncei.noaa.gov/access/monitoring/dyk/us-climate-divisions#grdd_">some fancy models</a> (weighting station data by area, quality control algorithms, etc.). Save this file in the data-raw folder.</p>
</section>
<section id="plot-annual-data" class="level3">
<h3 class="anchored" data-anchor-id="plot-annual-data">Plot annual data</h3>
<p>The annual data is shown as deviations from the mean of all year’s average temperature. Here too, the <strong>years</strong> which end up being included matter. So if/when the <code>min_year</code> parameter is adjusted above, this needs to get re-run.</p>
<p>The extreme years are labeled, but you may be adjusting the year threshold. You also may be needing to remove labels and nudge them up or down depending on what the data looks like.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 4 × 2
  temp_category     n
  &lt;fct&gt;         &lt;int&gt;
1 extreme cold      6
2 cold             48
3 hot              43
4 extreme hot       6</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 103 × 6
    Date  temp longterm_avg temp_anomaly temp_category color  
   &lt;dbl&gt; &lt;dbl&gt;        &lt;dbl&gt;        &lt;dbl&gt; &lt;fct&gt;         &lt;chr&gt;  
 1  1950  40.4         44.2        -3.75 extreme cold  #08519C
 2  1951  40.5         44.2        -3.65 extreme cold  #08519C
 3  1972  40.8         44.2        -3.35 extreme cold  #08519C
 4  1929  41           44.2        -3.15 extreme cold  #08519C
 5  1924  41.1         44.2        -3.05 extreme cold  #08519C
 6  2014  41.3         44.2        -2.85 extreme cold  #08519C
 7  1979  41.4         44.2        -2.75 cold          #2171B5
 8  1996  41.5         44.2        -2.65 cold          #2474B6
 9  1926  41.6         44.2        -2.55 cold          #2878B8
10  1965  41.7         44.2        -2.45 cold          #2B7BBA
# … with 93 more rows</code></pre>
</div>
<div class="cell-output-display">
<p><img src="README_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
<section id="combine-poster-elements" class="level2">
<h2 class="anchored" data-anchor-id="combine-poster-elements">Combine poster elements</h2>
<div class="cell">

</div>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>